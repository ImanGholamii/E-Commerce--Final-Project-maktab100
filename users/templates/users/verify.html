{% extends 'base.html' %}
{% load i18n %}
{% block background %}{% endblock background %}

{% block title %}Verify{% endblock title %}
{% load static %}
{% block content %}
<div class="container" style="margin-top: 50px;">
    <form method="post" class="form-pad" style="margin-left: 250px;margin-right: 250px; margin-bottom: 250px;">
        {% csrf_token %}
            {{ form.as_p }}
            <input type="submit" value="send">
    </form>
</div>
{% endblock %}
{# ==============================#}
{#{% extends 'base.html' %}#}
{#{% load i18n %}#}
{#{% block background %}{% endblock background %}#}
{##}
{#{% block title %}Verify{% endblock title %}#}
{#{% load static %}#}
{#{% block content %}#}
{#    <div class="container" style="margin-top: 50px;">#}
{#        <h2>{% trans 'Verify Code' %}</h2>#}
{##}
{#        {% if form.errors %}#}
{#            <ul>#}
{#                {% for field, errors in form.errors.items %}#}
{#                    <li>{{ field }}:#}
{#                        <ul>#}
{#                            {% for error in errors %}#}
{#                                <li>{{ error }}</li>#}
{#                            {% endfor %}#}
{#                        </ul>#}
{#                    </li>#}
{#                {% endfor %}#}
{#            </ul>#}
{#        {% endif %}#}
{##}
{#        <form method="post" class="form-pad" style="margin-left: 250px;margin-right: 250px; margin-bottom: 250px;">#}
{#            {% csrf_token %}#}
{#            {{ form.as_p }}#}
{#            <input type="submit" value="send">#}
{#        </form>#}
{#        <div style="margin-left: 250px;margin-right: 250px; margin-bottom: 250px;">#}
{#            {% if code_instance %}#}
{#                <p>Time remaining: <span id="countdown">{{ code_instance.get_time_remaining|default:10 }}</span></p>#}
{#                <button id="resend-code" onclick="resendCode()">{% trans 'Resend Code' %}</button>#}
{#                <a href="{% url 'index' %}">{% trans 'Cancel' %}</a>#}
{#            {% endif %}#}
{#        </div>#}
{#    </div>#}
{#    <script>#}
{##}
{#        var timerElement = document.getElementById('countdown');#}
{#        var timeRemaining = {{ code_instance.get_time_remaining|default:0 }};#}
{##}
{#        function updateTimer() {#}
{#            timerElement.innerText = formatTime(timeRemaining);#}
{#            timeRemaining -= 1;#}
{#            if (timeRemaining >= 0) {#}
{#                setTimeout(updateTimer, 1000);#}
{#            }#}
{#        }#}
{##}
{#        function formatTime(seconds) {#}
{#            var minutes = Math.floor(seconds / 60);#}
{#            var remainingSeconds = seconds % 60;#}
{#            return minutes + ':' + (remainingSeconds < 10 ? '0' : '') + remainingSeconds;#}
{#        }#}
{##}
{#        function resendCode() {#}
{#            var xhr = new XMLHttpRequest();#}
{#            xhr.open('POST', '{% url "resend_code" %}', true);#}
{#            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');#}
{#            xhr.onload = function () {#}
{#                if (xhr.status === 200) {#}
{#                    var response = JSON.parse(xhr.responseText);#}
{#                    if (response.success) {#}
{#                        timeRemaining = response.time_remaining;#}
{#                        updateTimer();#}
{#                    } else {#}
{#                        alert('Failed to resend code.');#}
{#                    }#}
{#                }#}
{#            };#}
{#            xhr.send(JSON.stringify({}));#}
{#        }#}
{##}
{#        updateTimer();#}
{#    </script>#}
{#{% endblock %}#}
